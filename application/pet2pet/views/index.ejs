<% include ../views/layout %>
<script
  src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
  integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
  crossorigin=""
></script>
<script src="https://api.mqcdn.com/sdk/mapquest-js/v1.3.2/mapquest.js"></script>
<link type="text/css" rel="stylesheet" href="https://api.mqcdn.com/sdk/mapquest-js/v1.3.2/mapquest.css"/>
<img src="https://i.imgur.com/pQKu6yH.jpg" title="source: imgur.com" class="w-50 p-3 img-fluid" alt="..." />
<h1 class="display-4">Welcome!</h1>
<script>
  var sveAdrese=[];
</script>
<ul>
    <h3>Catteries</h3>
  <% catteries.forEach(function(cattery){ %>
  <li>
    <a href="/cattery/<%=cattery.id%>"><%=cattery.name%></a>
  </li>
  <script>
    sveAdrese.push("<%= cattery.address%>");
    console.log(sveAdrese);
  </script>
  <% }) %>
  <h3>Breeds</h3> 
  <br />
  <% breeds.forEach(function(breed){ %>
    <li>
      <a href="/breed/<%=breed.id%>"><%=breed.breed%></a>
    </li>
    <% }) %>
    <br />
    <h3>Kittens</h3>
    <% kittens.forEach(function(kitten){ %>
      <li>
        <a href="/kitten/<%=kitten.id%>"><%=kitten.name%></a>
      </li>
      <% }) %>
      <br />
      <style>
        #map {
            width: 900px;
            height:400px;
        }
      </style> 
      <br/>
      <div id="map" class="w-100"></div> 
      <script type="text/javascript">
        window.onload = function() {
          L.mapquest.key = 'xZkpUhDeKCi3xZfhJVuTc52uc7s6tjN9';
          // Geocode three locations, then call the createMap callback
          console.log(sveAdrese);
          L.mapquest.geocoding().geocode(sveAdrese, createMap);
  
          function createMap(error, response) {
            // Initialize the Map
            var map = L.mapquest.map('map', {
              layers: L.mapquest.tileLayer('map'),
              center: [0, 0],
              zoom: 12
            });
  
            // Generate the feature group containing markers from the geocoded locations
            var featureGroup = generateMarkersFeatureGroup(response);
  
            // Add markers to the map and zoom to the features
            featureGroup.addTo(map);
            map.fitBounds(featureGroup.getBounds());
          }
  
          function generateMarkersFeatureGroup(response) {
            var group = [];
            for (var i = 0; i < response.results.length; i++) {
              var location = response.results[i].locations[0];
              var locationLatLng = location.latLng;
  
              // Create a marker for each location
              var marker = L.marker(locationLatLng, {icon: L.mapquest.icons.marker()})
                .bindPopup(location.adminArea5 + ', ' + location.adminArea3);
  
              group.push(marker);
            }
            return L.featureGroup(group);
          }
        }
      </script>    